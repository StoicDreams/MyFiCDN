"use strict";webui.define("webui-pagination",{preload:"button",constructor:t=>{t._slot=t.template.querySelector("slot"),t._prev=t.template.querySelector("div.prev"),t._pages=t.template.querySelector("div.pages"),t._next=t.template.querySelector("div.next"),t._btnFirst=t.template.querySelector("webui-button.first"),t._btnPrev=t.template.querySelector("webui-button.prev"),t._btnNext=t.template.querySelector("webui-button.next"),t._btnLast=t.template.querySelector("webui-button.last"),t._data=[],t.perPage=1,t._index=0,t.page=1,t._btnFirst.addEventListener("click",(_=>{1!==t.page&&t.setValue(1)})),t._btnPrev.addEventListener("click",(_=>{t.page>1?t.setValue(t.page-1):void 0!==t.loop&&t.setValue(t.pageCount)})),t._btnNext.addEventListener("click",(_=>{t.page<t.pageCount?t.setValue(t.page+1):void 0!==t.loop&&t.setValue(1)})),t._btnLast.addEventListener("click",(_=>{t.page!==t.pageCount&&t.setValue(t.pageCount)}))},attr:["data-current","data-subscribe","value","page","per-page","hide-prev-next-buttons","hide-pages","loop"],attrChanged:(t,property,value)=>{switch(property){case"perPage":let num=parseInt(value);`${num}`===value&&(t.perPage=num);break;case"page":case"value":t.setValue(value)}},connected:t=>{let data="";if(t._slot.assignedElements().length){let ch=[];t._slot.assignedElements().forEach((node=>{ch.push(node.innerText)})),data=ch.join("\n"),t.setData(data)}let ds=t.dataset.subscribe;ds&&ds.split("|").forEach((ds=>{let kt=ds.split(":");if(2===kt.length&&"setData"===kt[1]){let attempts=0;function tryGetData(){t._data&&t._data.length||(data=webui.getData(kt[0]),data?t.setData(data):++attempts<5&&setTimeout((()=>tryGetData()),100*attempts))}tryGetData()}}))},process:function(){let t=this;if(!t._data||!t._data.forEach)return;let current={};if(0===t._data.length)return t.pageCount=0,void(t.dataCurrent&&webui.setData(t.dataCurrent,current));if(t._index>=t._data.length&&(t._index=0,t.page=1,t.value=1),1===t.perPage)current=t._data[t._index];else{current=[];for(let index=t._index;index<t._data.length;++index)current.push(t._data[index])}if(webui.setData(t.dataCurrent,current),t.pageCount=Math.ceil(t._data.length/t.perPage),t._pages.innerText="",1==t.page?t._btnFirst.setAttribute("theme","active"):t._btnFirst.removeAttribute("theme"),t.page==t.pageCount?t._btnLast.setAttribute("theme","active"):t._btnLast.removeAttribute("theme"),!t.hidePages)for(let pn=1;pn<=t.pageCount;++pn){let page=webui.create("webui-button",{html:`${pn}`}),pageNumber=pn;pn===t.page?page.setAttribute("theme","active"):page.addEventListener("click",(_=>{t.setValue(pageNumber)})),t._pages.appendChild(page)}},setValue:function(value){let t=this;void 0!==value&&void 0!==value&&("string"==typeof value&&(value=parseInt(value)),"number"==typeof value&&(t._index=value<1?0:value-1,t.page=t._index+1,t.value=t.page,t.process()))},setData:function(value){let t=this;if("string"==typeof value)try{value?value=JSON.parse(value):t._data=[]}catch(ex){return void console.error("Failed parsing data",value)}if(null==value)return t._data=[],void t.process();value.forEach||(value=[value]),t._data=value,t.process()},shadowTemplate:'\n<div class="spacer-left"></div>\n<div class="prev">\n<webui-button class="first" start-icon="left-to-line"></webui-button>\n<webui-button class="prev" start-icon="left"></webui-button>\n</div>\n<div class="pages"></div>\n<div class="next">\n<webui-button class="next" start-icon="right"></webui-button>\n<webui-button class="last" start-icon="right-to-line"></webui-button>\n</div>\n<div class="spacer-right"></div>\n<pre><slot></slot></pre>\n<style type="text/css">\n:host {\ndisplay:grid;\ngrid-template-columns:auto max-content max-content max-content 0;\ngap:var(--padding);\n}\ndiv.prev,\ndiv.pages,\ndiv.next {\ndisplay:flex;\ngap:var(--padding);\n}\npre {\ndisplay:none;\n}\n</style>'});