"use strict";webui.define("webui-dialog-action",{content:!0,linkCss:!1,watchVisibility:!1,isInput:!1,preload:"",apiMethod:"post",contentType:"application/json",constructor:t=>{t._slotMain=t.template.querySelector("slot:not([name])"),t._slotSomething=t.template.querySelector('slot[name="something"]')},props:{sample:{get(){return this._sample},set(v){this._sample=v}}},flags:[],attr:["api","confirm","content-type"],attrChanged:(t,property,value)=>{switch(property){case"api":let segments=value.split("|"),api=value;segments.length>1&&-1!==["get","post","put","delete","patch"].indexOf(segments[0].toLowercase())&&(t.apiMethod=segments[0],api=segments[1]),api&&(t.apiUrl=api),console.log("debug",api,segments,t.apiUrl);break;case"maxHeight":t.style.maxHeight=webui.pxIfNumber(value)}},setValue:async function(value){if(void 0===value)return;const t=this;let content="";t.dataset.subscribe&&webui.setData(t.dataset.subscribe,void 0),console.log("assigned",t._slotMain.assignedElements()),t._slotMain.assignedElements().forEach((node=>{if(console.log("node",node,node.nodeName),"TEMPLATE"===node.nodeName)content=`${content}${node.innerHTML}`;else node.outerHTML&&(content=`${content}${node.outerHTML}`)})),webui.dialog({confirm:t.confirm||"Confirm",cancel:"Cancel",content:content,title:t.title||"Action",minWidth:"80%",onconfirm:(data,content)=>new Promise((resolve=>{let method=t.apiMethod,url=t.apiUrl;if(console.log("confirm",method,url),url){let ct=t.contentType||"application/json",fetchData=null;"get"!==method.toLowercase()&&("multipart/form-data"===ct?fetchData=data:(fetchData=Object.fromEntries(data),0===Object.keys(fetchData).length&&Object.assign(fetchData,value),fetchData.headers={"Content-Type":ct})),webui.fetchApi(url,fetchData,method).then((async resp=>{let message=await resp.text();resp.status<300?(resolve(!0),message&&webui.alert(message,"success")):(resolve(!1),message&&webui.alert(message))})).catch((ex=>{resolve(!1)}))}else webui.log.warn("API is not set for webui-dialog-action"),resolve(!0)}))}).catch((_=>{}))},connected:function(t){t.setupComponent()},disconnected:function(t){},reconnected:function(t){},setupComponent:function(){},shadowTemplate:'\n<slot></slot>\n<slot name="something"></slot>\n<style type="text/css">\n:host {\ndisplay:none;\n}\n</style>\n'});