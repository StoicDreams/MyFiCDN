/*!
 * Web UI Condition - https://webui.stoicdreams.com/components#webui-condition
 * A component for managing conditional content display.
 * Authored by Erik Gassler - Stoic Dreams
 * Copyright Â© 2024-2025 Stoic Dreams - https://www.stoicdreams.com
 * Licensed under the MIT license - https://github.com/StoicDreams/MyFiCDN/blob/main/LICENSE
 */
"use strict";webui.define("webui-condition",{constructor:t=>{t._data={},t._slotValid=t.template.querySelector('slot[name="valid"]'),t._slotInvalid=t.template.querySelector('slot[name="invalid"]'),t.childNodes.forEach((node=>{node&&node.hasAttribute&&("TEMPLATE"!==node.nodeName||node.hasAttribute("slot")||node.setAttribute("slot","valid"))})),t.querySelectorAll("p > template").forEach((template=>{template.hasAttribute("slot")||template.setAttribute("slot","valid"),t.appendChild(template)})),t.querySelectorAll("p").forEach((p=>{""===p.innerHTML.trim()&&p.remove()}))},attr:["data-subscribe","value"],attrChanged:(t,property,value)=>{switch(property){case"dataSubscribe":t.checkConditions();break;case"value":t.dataset.value=value,t.checkConditions()}},connected:t=>{t._isConnected=!0;let content=[],invalid=[];t._slotValid.assignedElements().forEach((template=>{content.push(template.innerHTML)})),t._slotInvalid.assignedElements().forEach((template=>{invalid.push(template.innerHTML)})),t._cacheContent=content.join("\n"),t._cacheInvalid=invalid.join("\n"),t.checkConditions()},setValue:function(value,key){const t=this;if("value"===key)t.dataset.value=value;t._data[key]=void 0===value?"":value,t.checkConditions()},valueIsGood:function(val){return!(!val||-1!==["0","false","null","undefined","[]","{}"].indexOf(val)||val.forEach&&0===val.length)&&("string"!=typeof val||!val.startsWith("{TEMPLATE_"))},checkConditions:function(){const t=this;if(!t._isConnected)return;let keys=t.dataset.subscribe;if(!keys&&!t.dataset.value)return void t.showInvalid();let mustEqual=t.dataset.equals,mustContain=t.dataset.contains,notEqual=t.dataset.unequals,ignoreCase=void 0!==t.dataset.ignoreCase,mustMatch=t.dataset.match,isGood=!0,isGeneralCheck=void 0===mustEqual&&void 0===mustContain&&void 0===notEqual&&void 0===mustMatch;function checkValue(value){let vt=`${value}`;if(ignoreCase&&(vt=vt.toLowerCase()),isGeneralCheck)t.valueIsGood(value)||(isGood=!1);else{if(void 0!==mustMatch){new RegExp(mustMatch,"g")||(isGood=!1)}else void 0!==notEqual&&(value!==notEqual&&vt!==notEqual||(isGood=!1));void 0!==mustEqual&&value!==mustEqual&&vt!==mustEqual&&(isGood=!1),void 0!==mustContain&&-1===vt.indexOf(mustContain)&&(isGood=!1)}}keys&&keys.split&&keys.split("|").forEach((key=>{checkValue(webui.getData(key))})),void 0!==t.dataset.value&&checkValue(t.dataset.value),isGood?t.showContent():t.showInvalid()},showContent:function(){const t=this;webui.removeChildren(t,(ch=>!ch||!ch.hasAttribute||!ch.hasAttribute("slot"))),t._cacheContent&&webui.transferChildren(webui.create("div",{html:webui.applyAppDataToContent(t._cacheContent,t._data)}),t)},showInvalid:function(){const t=this;webui.removeChildren(t,(ch=>!ch||!ch.hasAttribute||!ch.hasAttribute("slot"))),t._cacheInvalid&&webui.transferChildren(webui.create("div",{html:webui.applyAppDataToContent(t._cacheInvalid,t._data)}),t)},shadowTemplate:'\n<slot></slot>\n<slot name="valid"></slot>\n<slot name="invalid"></slot>\n<style style="text/css">\n:host {\ndisplay:inline;\nwidth:100%;\nwidth:-webkit-fill-available;\n}\nslot[name] {\ndisplay:none;\n}\n</style>\n'});