"use strict";{const srcRoot="MyFi CDN"===webui.getData("appName")?"/icons/":"https://cdn.myfi.ws/icons/",previewHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="-100 -100 200 200">\n\x3c!--! Stoic Dreams - https://webui.stoicdreams.com License - https://webui.stoicdreams.com/license Copyright 2024 Stoic Dreams Inc. --\x3e\n<path class="i1" d=""></path>\n<path class="i2" d=""></path>\n<path class="i3" d=""></path>\n<path class="i4" d=""></path>\n<path class="i5" d=""></path>\n<path class="i6" d=""></path>\n<path class="i7" d=""></path>\n<path class="i8" d=""></path></svg>';webui.define("webui-icon-creator",{preload:"icon dropdown",constructor:t=>{function setPlaceholderCoord(path,index){let y=4*index-98;path._cOrigin={x:-100,y:y};let cq=[];for(let q=1;q<12;++q)cq.push({x:5*q-100,y:y,qx:5*q-100,qy:y});return path._cQ=cq,path._buildDef(),path}t._topGrid=webui.create("webui-grid",{columns:"1fr 1fr",gap:"1"}),t._leftGrid=webui.create("webui-grid",{gap:"1",theme:"black",width:"100",height:"100"}),t._rightGrid=webui.create("webui-grid",{gap:"1",theme:"white",width:"100",height:"100"}),t._topGrid.appendChild(t._leftGrid),t._topGrid.appendChild(t._rightGrid),t._iconOptions=webui.create("webui-flex",{justify:"center"}),t._inputs=webui.create("webui-grid",{columns:"1fr 1fr"}),t._svgContainer=webui.create("div",{style:"display:block;position:relative;aspect-ratio:1;padding:0;margin:0;"}),t._svgPreview=webui.createFromHTML(previewHTML,{style:"aspect-ratio:1;background-color:#DDF;color:#333;stroke:blue;stroke-width:15;fill:#FFFF0088;"}),t._svgContainer.appendChild(t._svgPreview),t._svgPPaths=[];for(let i=1;i<=8;++i){let path=t._svgPreview.querySelector(`.i${i}`);t._svgPPaths.push(path),t._svgPreview.appendChild(path),path._buildDef=function(){let d=[];d.push(`M${path._cOrigin.x} ${path._cOrigin.y}`),path._cQ.forEach((cq=>{d.push(`Q${cq.qx} ${cq.qy} ${cq.x} ${cq.y}`)}));let ds=d.join("")+"z";return path.getAttribute("d")!==ds&&path.setAttribute("d",ds),ds},setPlaceholderCoord(path,i-1)}function getGrabStyle(color,z){return`position:absolute;aspect-ratio:1;width:2.5%;border-radius:100%;transform:translate(-50%,-50%);background-color:${color};z-index:${z};`}function applySnapping(value){return stepAlt?value:value-value%5}function processMove(ev){let x=ev.pageX,y=ev.pageY,mx=x-moving._moveOX,my=y-moving._moveOY;stepAlt=ev.ctrlKey,moving._isQuad?(moving._myData.qx=applySnapping(moving._dataOX+pxToPath(mx)),moving._myData.qy=applySnapping(moving._dataOY+pxToPath(my)),moving.style.top=`${pathToRel(moving._myData.qy)}%`,moving.style.left=`${pathToRel(moving._myData.qx)}%`,movingPair&&(movingPair._myData.x=applySnapping(movingPair._dataOX+pxToPath(mx)),movingPair._myData.y=applySnapping(movingPair._dataOY+pxToPath(my)),movingPair.style.top=`${pathToRel(movingPair._myData.y)}%`,movingPair.style.left=`${pathToRel(movingPair._myData.x)}%`)):(moving._myData.x=applySnapping(moving._dataOX+pxToPath(mx)),moving._myData.y=applySnapping(moving._dataOY+pxToPath(my)),moving.style.top=`${pathToRel(moving._myData.y)}%`,moving.style.left=`${pathToRel(moving._myData.x)}%`,movingPair&&(movingPair._myData.qx=applySnapping(movingPair._dataOX+pxToPath(mx)),movingPair._myData.qy=applySnapping(movingPair._dataOY+pxToPath(my)),movingPair.style.top=`${pathToRel(movingPair._myData.qy)}%`,movingPair.style.left=`${pathToRel(movingPair._myData.qx)}%`)),function(){let builder=[];builder.push(defName),t._svgPPaths.forEach((path=>{let line=path._buildDef();line.startsWith("M-100")||builder.push(line)}));let value=builder.join("\n");t._input.value=value,icons.forEach((icon=>{icon.setIconDefinition(value)}))}()}t._svgPreview.addEventListener("click",(ev=>{if(moving)return ev.stopPropagation(),ev.preventDefault(),!1})),t._svgPreview.addEventListener("contextmenu",(ev=>(ev.stopPropagation(),ev.preventDefault(),!1))),t._svgPreview.addEventListener("mousedown",(ev=>(ev.stopPropagation(),ev.preventDefault(),!1))),t._svgPreview.addEventListener("mousemove",(ev=>{if(moving)return ev.stopPropagation(),ev.preventDefault(),processMove(ev),!1})),t._svgPreview.addEventListener("mouseup",(ev=>{if(moving)return ev.stopPropagation(),ev.preventDefault(),moving=null,!1})),t._svgPreview.addEventListener("mouseleave",(ev=>{if(moving&&"svg"===ev.relatedTarget)return ev.stopPropagation(),ev.preventDefault(),moving=null,!1}));let moving=null,movingPair=null,stepAlt=!1;function setupGrabberEvents(grabber,data,isQuad,pairGrabber){grabber._myData=data,grabber._isQuad=!!isQuad,grabber.addEventListener("mouseup",(ev=>{moving=null,movingPair=null})),grabber.addEventListener("mousemove",(ev=>{if(moving)return ev.stopPropagation(),ev.preventDefault(),processMove(ev),!1})),grabber.addEventListener("mousedown",(ev=>(ev.stopPropagation(),ev.preventDefault(),console.log("shift",ev.shiftKey),grabber._dataOX=isQuad?data.qx:data.x,grabber._dataOY=isQuad?data.qy:data.y,grabber._moveOX=ev.pageX,grabber._moveOY=ev.pageY,moving=grabber,ev.shiftKey&&pairGrabber?(movingPair=pairGrabber,pairGrabber._dataOX=isQuad?data.x:data.qx,pairGrabber._dataOY=isQuad?data.y:data.qy):movingPair=null,stepAlt=ev.ctrlKey,!1)))}t._svgPPaths.forEach((path=>{path._grab={main:webui.create("a",{style:getGrabStyle("purple",100)}),quads:[]},setupGrabberEvents(path._grab.main,path._cOrigin,!1),t._svgContainer.appendChild(path._grab.main);for(let gi=0;gi<11;++gi){let g={main:webui.create("a",{style:getGrabStyle("red",101)}),quad:webui.create("a",{style:getGrabStyle("green",102)})};setupGrabberEvents(g.main,path._cQ[gi],!1,g.quad),setupGrabberEvents(g.quad,path._cQ[gi],!0,g.main),path._grab.quads.push(g),t._svgContainer.appendChild(g.main),t._svgContainer.appendChild(g.quad)}}));let lastDrawn="";function pathToRel(p){return.5*(p+100)}function pxToPath(px){let ratio=200/t._svgPreview.clientWidth;return Math.round(px*ratio)}function setupPath(path){path.getAttribute("d").startsWith("M-100")?path.style.strokeWidth="2":path.style.strokeWidth="5",function(path){path._grab.main.style.top=`${pathToRel(path._cOrigin.y)}%`,path._grab.main.style.left=`${pathToRel(path._cOrigin.x)}%`;let index=0;path._grab.quads.forEach((quad=>{let d=path._cQ[index++];quad.main.style.left=`${pathToRel(d.x)}%`,quad.main.style.top=`${pathToRel(d.y)}%`,quad.quad.style.left=`${pathToRel(d.qx)}%`,quad.quad.style.top=`${pathToRel(d.qy)}%`}))}(path)}function getCoord(subdef){let c={x:0,y:0,qx:0,qy:0},s="",index=0,isM=!1;function setValue(){let val=parseFloat(s);s="",1==++index?isM?c.x=val:c.qx=val:2===index?isM?c.y=val:c.qy=val:3===index?c.x=val:4===index&&(c.y=val)}return subdef.split("").forEach((char=>{switch(char){case"M":isM=!0;break;case"Z":case"m":case"z":break;case" ":""!==s&&setValue();break;case"-":""!==s&&setValue(),s="-";break;default:s=`${s}${char}`}})),""!==s&&setValue(),c}function setPathDefinition(path,definition){let segments=definition.split("Q"),main=getCoord(segments.shift());path._cOrigin.x=main.x,path._cOrigin.y=main.y;let index=0;for(;segments.length>0;){let quad=getCoord(segments.shift()),i=index++;path._cQ[i].x=quad.x,path._cQ[i].y=quad.y,path._cQ[i].qx=quad.qx,path._cQ[i].qy=quad.qy}path._buildDef()}let defName="WEBUI-ICON-NAME";t._inputs.appendChild(t._svgContainer);let icons=[];function setupToggleIcon(name,label,flagAttr){t[name]=webui.create("webui-toggle-icon",{label:label,"title-on":`Disable ${label}`,"title-off":`Enable ${label}`,"theme-on":"success","theme-off":"shade","flags-on":"fill","flags-off":""}),t[name].addEventListener("change",(_=>{icons.forEach((icon=>{t[name].value?icon.setAttribute(flagAttr,""):icon.removeAttribute(flagAttr)}))}))}[{l:"Regular",d:{}},{l:"Thin",d:{thin:""}},{l:"Thick",d:{thick:""}},{l:"Square",d:{square:""}},{l:"Circle",d:{circle:""}},{l:"Duo-Tone",d:{duo:""}},{l:"Tri-Tone",d:{tri:""}},{l:"Inverted",d:{inverted:""}}].forEach((def=>{let attributes=def.d;attributes.width="100px",attributes.class="my-1";let iconLeft=webui.create("webui-icon",attributes),iconRight=webui.create("webui-icon",attributes);icons.push(iconLeft),icons.push(iconRight);let left=webui.create("webui-flex",{column:"1"}),right=webui.create("webui-flex",{column:"1"});t._leftGrid.appendChild(left),left.appendChild(iconLeft),left.appendChild(webui.create("label",{text:def.l,class:"text-center"})),t._rightGrid.appendChild(right),right.appendChild(iconRight),right.appendChild(webui.create("label",{text:def.l,class:"text-center"}))})),t._color=webui.create("webui-dropdown",{label:"Icon Theme"}),t._color.addEventListener("change",(_=>{let theme=t._color.value;t._topGrid.querySelectorAll("webui-icon").forEach((icon=>{theme?icon.setAttribute("theme",theme):icon.removeAttribute("theme")}))})),setupToggleIcon("_backingToggle","Backing","backing"),setupToggleIcon("_sharpToggle","Sharp","sharp"),setupToggleIcon("_fillToggle","Fill","fill"),setupToggleIcon("_borderToggle","Bordered","bordered"),setupToggleIcon("_circleToggle","Circle","circle");let inputsColumn=webui.create("webui.flex",{column:""});t._input=webui.create("webui-input-message",{label:"Definition",value:"WEBUI-ICON-DEF\n",placeholder:"WEBUI-ICON-NAME"}),t._inputs.appendChild(inputsColumn),inputsColumn.appendChild(webui.create("h6",{html:"<strong>Movement Modifiers</strong>"})),inputsColumn.appendChild(webui.create("p",{class:"pl-4",html:"<strong>CTRL</strong> Precision Movement"})),inputsColumn.appendChild(webui.create("p",{class:"pl-4",html:"<strong>SHIFT</strong> Move Pair"})),inputsColumn.appendChild(t._input),t._input.addEventListener("input",(_=>{let value=t._input.value;value?(!function(definition){if(!definition)return;if(definition===lastDrawn)return;lastDrawn=definition;let lines=definition.split("\n");if(0===lines.length)return;lines[0].startsWith("WEBUI-ICON-")&&(defName=lines.shift());let i=0;for(;i<lines.length&&i<t._svgPPaths.length;)lines[i]?setPathDefinition(t._svgPPaths[i],lines[i]):setPlaceholderCoord(t._svgPPaths[i],i),setupPath(t._svgPPaths[i]),++i;for(;i<t._svgPPaths.length;)setPlaceholderCoord(t._svgPPaths[i],i),setupPath(t._svgPPaths[i]),++i}(value),icons.forEach((icon=>{icon.setIconDefinition(value)}))):t._input.value="WEBUI-ICON-DEF"})),t._bottomGrid=webui.create("webui-grid",{gap:"1",theme:"inherit",width:"100",height:"100"})},connected:t=>{t.style.display="flex",t.style.flexDirection="column",t.style.flexGap="var(--padding)",t.appendChild(t._topGrid),t.appendChild(t._iconOptions),t._iconOptions.appendChild(t._color),t._iconOptions.appendChild(t._backingToggle),t._iconOptions.appendChild(t._sharpToggle),t._iconOptions.appendChild(t._fillToggle),t._iconOptions.appendChild(t._borderToggle),t._iconOptions.appendChild(t._circleToggle),t.appendChild(t._inputs),t.appendChild(t._bottomGrid),t.loadIcons();let options=JSON.stringify([{value:"",display:"None"},{value:"black",display:"Black"},{value:"white",display:"White"},{value:"title",display:"Title"},{value:"primary",display:"Primary"},{value:"secondary",display:"Secondary"},{value:"tertiary",display:"Tertiary"},{value:"info",display:"info"},{value:"success",display:"success"},{value:"warning",display:"warning"},{value:"danger",display:"danger"},{value:"active",display:"Active"},{value:"button",display:"Button"},{value:"action",display:"Action"}]);t._color.setAttribute("options",options)},loadFromDefinition:function(iconDef){},loadIcons:async function(){let t=this;try{let result=await fetch(`${srcRoot}all.json`);if(!result.ok)return;let icons=await result.json(),isFirst=!0;icons.forEach((icon=>{let container=webui.create("a",{style:"flex-direction:column;"});t._bottomGrid.appendChild(container);let el=webui.create("webui-icon",{icon:icon,width:"100"});container.appendChild(el);let label=webui.create("label",{text:icon});container.appendChild(label),container.addEventListener("click",(_=>{t._input.value=el._definition,t._input.dispatchEvent(new Event("input",{bubbles:!0}))})),isFirst&&(isFirst=!1,setTimeout((()=>{t._input.value=el._definition,t._input.dispatchEvent(new Event("input",{bubbles:!0}))}),100))}))}catch(ex){console.error("Failed loading icons list",ex)}}})}